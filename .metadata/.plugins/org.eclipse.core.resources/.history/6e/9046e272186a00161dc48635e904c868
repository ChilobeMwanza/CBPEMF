package change;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import org.eclipse.emf.common.notify.Notification;
import org.eclipse.emf.ecore.EAttribute;
import org.eclipse.emf.ecore.EObject;

public class EAttributeEvent extends Event
{
	private EObject focus_obj;
	
	private EAttribute attr;
	
	private List<Object> attr_values_list = new ArrayList<Object>();
	
	public enum EAttributeEventType
	{
		SET,
		UNSET;
	}
	
	EAttributeEventType type;
	 
    @SuppressWarnings("unchecked")
	public EAttributeEvent(EObject focus_obj, EAttribute attr, Object value, EAttributeEventType type)
    {
       super(Event.EATTRIBUTE_EVENT);
       
       this.focus_obj = focus_obj;
       this.attr = attr;
       
       if(value instanceof Collection)
    	   this.attr_values_list = (List<Object>) value;
       
       else
    	   this.attr_values_list.add(value);
       
       this.type = type;
       
    }
    
    @SuppressWarnings("unchecked")
    public EAttributeEvent(Notification n, EAttributeEventType type)
    {
    	super(Event.EATTRIBUTE_EVENT);
        
        this.type = type;
        
        Object value = null;
        
        if(type == EAttributeEventType.SET)
        {
        	value = n.getNewValue();
        }
        
      
        
        if(value == null)
        	value = n.getOldValue();
        
        this.focus_obj = (EObject) n.getNotifier();
        
        this.attr = (EAttribute) n.getFeature();
        
        if(value instanceof Collection)
     	   this.attr_values_list = (List<Object>) value;
        
        else
     	   this.attr_values_list.add(value);
        
    }
    
    public EObject getFocusObj()
    {
        return this.focus_obj;
    }
    
    public EAttribute getEAttribute()
    {
        return this.attr;
    }
    
    public List<Object> getAttributeValuesList()
    {
        return this.attr_values_list;
    }
    
    public EAttributeEventType getType()
    {
    	return type;
    }

}
