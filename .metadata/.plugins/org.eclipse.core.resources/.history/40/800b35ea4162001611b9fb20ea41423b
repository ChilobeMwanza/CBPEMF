package tests;

import java.io.File;

import org.eclipse.emf.common.util.URI;
import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.EPackage;
import org.eclipse.emf.ecore.resource.Resource;
import org.eclipse.emf.ecore.resource.ResourceSet;
import org.eclipse.emf.ecore.resource.impl.ResourceSetImpl;
import org.eclipse.emf.ecore.util.BasicExtendedMetaData;
import org.eclipse.emf.ecore.util.ExtendedMetaData;
import org.eclipse.emf.ecore.xmi.XMLResource;
import org.eclipse.emf.ecore.xmi.impl.EcoreResourceFactoryImpl;
import org.junit.Test;

import impl.DeltaResourceImpl;

public class SystemTest extends TestBase 
{
	private EPackage ePackage = null;
	private String ecoreFileLocation = new File("").getAbsolutePath()+"/model/university.ecore";
	
	@Override
	public void runOnceBeforeTest()
	{
		super.runOnceBeforeTest();
		  
	    //Register epackage reflectively
		Resource.Factory.Registry.INSTANCE.getExtensionToFactoryMap().put(
			    "ecore", new EcoreResourceFactoryImpl());Resource.Factory.Registry.INSTANCE.
			    getExtensionToFactoryMap().put("*", new EcoreResourceFactoryImpl()); 
		
		
		ResourceSet rs = new ResourceSetImpl();
		
		Resource r = rs.getResource(URI.createFileURI(ecoreFileLocation), true);
		
		EObject eObject = r.getContents().get(0);
		
		if (eObject instanceof EPackage) 
		{
		    ePackage = (EPackage)eObject;
		    rs.getPackageRegistry().put(ePackage.getNsURI(), ePackage);
		}	
	}
	
	

	@Test
	public void testTextSerialisation()
	{
		Resource res = new DeltaResourceImpl(URI.createURI(fileSaveLocation));
	}
	
	private EObject createEObject(String eClassName) //does this need to be a method?
	{
		return ePackage.getEFactoryInstance().create((EClass)
				ePackage.getEClassifier(eClassName));
	}
}
