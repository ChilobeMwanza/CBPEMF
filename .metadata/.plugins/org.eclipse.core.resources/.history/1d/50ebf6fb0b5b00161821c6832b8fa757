/**
 * notification.getNotifier().getClass(); should use eclass instead, but how?
 */
package change;

import org.eclipse.emf.common.notify.Notification;
import org.eclipse.emf.ecore.EAttribute;
import org.eclipse.emf.ecore.EObject;

import org.eclipse.emf.ecore.util.EContentAdapter;

public class EventAdapter extends EContentAdapter
{
	private ChangeLog changelog;
	private final String RESOURCE_NAME = "DeltaResourceImpl";
	private  final String classname = this.getClass().getSimpleName();
	
	private boolean adapterEnabled = true;
	
	public EventAdapter(ChangeLog aChangelog)
	{
		this.changelog = aChangelog;
	}
	
	@Override
	public void notifyChanged(Notification n)
	{
		super.notifyChanged(n);
		
		if(n.isTouch() || !adapterEnabled)
			return;
		
		switch(n.getEventType())
		{
			case Notification.ADD :
			{
				changelog.addNotification(n);
				break;		
			}
			case Notification.ADD_MANY : 
			{
				changelog.addNotification(n);
				break;
			}
			case Notification.REMOVE:
			{
				//changelog.addNotification(n);
				break;
			}
			case Notification.SET:
			{
				if(n.getFeature() instanceof EAttribute || n.getNewValue() instanceof EObject)
				{
					changelog.addNotification(n);
				}
				break;
			}
			case Notification.UNSET: //tbr
			{
				if(n.getFeature() instanceof EAttribute || n.getNewValue() instanceof EObject)
				{
					//changeLog.addNotification(n);
					System.out.println(classname+" UNSET!");
				}
				System.out.println(classname+"unset happens still");
				break;
			}
				
			default:
				//System.out.println("EventAdapater.java default");
				break;
		}
	}
	
	public void setEnabled(boolean bool)
	{
		adapterEnabled = bool;
	}
}
